{"version":3,"file":"aimapi.js","sources":["../src/aimConf.js","../utils/modality.js","../utils/aid.js","../src/Aim.jsx","../src/aimHelper.js"],"sourcesContent":["export default {\n  aimVersion: \"AIMv4_2\",\n  \"xmlns:xsi\": \"http://www.w3.org/2001/XMLSchema-instance\",\n  \"xmlns:rdf\": \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\n  xmlns: \"gme://caCORE.caCORE/4.4/edu.northwestern.radiology.AIM\",\n  \"xsi:schemaLocation\":\n    \"gme://caCORE.caCORE/4.4/edu.northwestern.radiology.AIM AIM_v4.2_rv2_XML.xsd\"\n};\n","var dcmDesignator = \"DCM\";\nvar lexVersion = \"20121129\";\n//from the link below\n//http://dicom.nema.org/medical/dicom/current/output/chtml/part16/sect_CID_29.html\n//http://www.dicomlibrary.com/dicom/sop/\n\n//Default Values=> codeValue:99EPADM0 codeMaeaning:NA codingSchemeDesignator:99EPAD\n\nexport var modalities = {\n  \"1.2.840.10008.5.1.4.1.1.2\": {\n    codeValue: \"CT\",\n    codeMeaning: \"Computed Tomography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  \"1.2.840.10008.5.1.4.1.1.1\": {\n    codeValue: \"CR\",\n    codeMeaning: \"Computed Radiography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  \"1.2.840.10008.5.1.4.1.1.128\": {\n    codeValue: \"PT\",\n    codeMeaning: \"Positron emission tomography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  \"1.2.840.10008.5.1.4.1.1.4\": {\n    codeValue: \"MR\",\n    codeMeaning: \"Magnetic Resonance\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  \"1.2.840.10008.5.1.4.1.1.6.1\": {\n    codeValue: \"US\",\n    codeMeaning: \"Ultrasound\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  \"1.2.840.10008.5.1.4.1.1.1.2\": {\n    codeValue: \"MG\",\n    codeMeaning: \"Mammography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  \"1.2.840.10008.5.1.4.1.1.1.2.1\": {\n    codeValue: \"MG\",\n    codeMeaning: \"Mammography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  CT: {\n    codeValue: \"CT\",\n    codeMeaning: \"Computed Tomography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  CR: {\n    codeValue: \"CR\",\n    codeMeaning: \"Computed Radiography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  PT: {\n    codeValue: \"PT\",\n    codeMeaning: \"Positron emission tomography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  MR: {\n    codeValue: \"MR\",\n    codeMeaning: \"Magnetic Resonance\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  US: {\n    codeValue: \"US\",\n    codeMeaning: \"Ultrasound\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  },\n  MG: {\n    codeValue: \"MG\",\n    codeMeaning: \"Mammography\",\n    codingSchemeDesignator: dcmDesignator,\n    codingSchemeVersion: lexVersion\n  }\n};\n","/**\n * For creating DICOM uids\n * Taken from dcmjs MetaDictionary\n * https://github.com/dcmjs-org/dcmjs/blob/master/src/DicomMetaDictionary.js#L5\n */\nexport function generateUid() {\n  let uid = \"2.25.\" + Math.floor(1 + Math.random() * 9);\n  for (let index = 0; index < 38; index++) {\n    uid = uid + Math.floor(Math.random() * 10);\n  }\n  return uid;\n}\n\nexport function persistExpandView(expanded, data, newData, id) {\n  const expandMap = {};\n  let counter = 0;\n  newData.forEach((el, i) => {\n    if (counter < data.length) {\n      if (el[id] === data[counter][id]) {\n        expandMap[i] = expanded[counter];\n        counter += 1;\n      } else {\n        expandMap[i] = false;\n      }\n    }\n  });\n  return expandMap;\n}\n","import aimConf from \"./aimConf\";\nimport { modalities } from \"../utils/modality\";\nimport { generateUid } from \"../utils/aid\";\n\nclass Aim {\n  constructor(imageData, aimType, updatedAimId) {\n    this.temp = {};\n    ({\n      aim: this.temp.aim,\n      study: this.temp.study,\n      series: this.temp.series,\n      image: this.temp.image,\n      segmentation: this.temp.segmentation,\n      equipment: this.temp.equipment,\n      user: this.temp.user,\n      person: this.temp.person,\n    } = imageData);\n    this.xmlns = aimConf.xmlns;\n    this[\"xmlns:rdf\"] = aimConf[\"xmlns:rdf\"];\n    this[\"xmlns:xsi\"] = aimConf[\"xmlns:xsi\"];\n    this.aimVersion = aimConf.aimVersion;\n    this[\"xsi:schemaLocation\"] = aimConf[\"xsi:schemaLocation\"];\n    this.uniqueIdentifier = \"\";\n    this.studyInstanceUid = { root: this.temp.aim.studyInstanceUid };\n    this.seriesInstanceUid = { root: generateUid() };\n    this.accessionNumber = { value: this.temp.study.accessionNumber };\n    this.dateTime = { value: this.getDate() };\n    this.user = this._createUser(this.temp.user);\n    this.equipment = this._createEquipment(this.temp.equipment);\n    this.person = this._createPerson(this.temp.person);\n    this.imageAnnotations = {\n      ImageAnnotation: [this._createImageAnnotations(aimType)],\n    };\n    if (updatedAimId === undefined)\n      this.uniqueIdentifier = { root: generateUid() };\n    else this.uniqueIdentifier = { root: updatedAimId };\n  }\n\n  static parse(data) {\n    return new Aim(data);\n  }\n\n  // static getMarkups(aim) {\n  //   let annotations = [];\n  //   let annotation = {};\n  //   const markupEntities =\n  //     aim.imageAnnotations.ImageAnnotation.markupEntityCollection.MarkupEntity;\n\n  //   if (markupEntities.constructor === Array) {\n  //     markupEntities.map(markupEntity => {\n  //       var imageId = markupEntity[\"imageReferenceUid\"][\"root\"];\n  //       var markupUid = markupEntity[\"uniqueIdentifier\"][\"root\"];\n  //       var calculations = this.getCalculationEntitiesOfMarkUp(aim, markupUid);\n  //       annotations.push({\n  //         imageId: imageId,\n  //         markupType: markupEntity[\"xsi:type\"],\n  //         coordinates:\n  //           markupEntity.twoDimensionSpatialCoordinateCollection\n  //             .TwoDimensionSpatialCoordinate,\n  //         calculations: calculations\n  //       });\n  //       this.getCalculationEntitiesOfMarkUp(aim);\n  //     });\n  //     return annotations;\n  //   } else if (\n  //     Object.entries(markupEntities).length !== 0 &&\n  //     markupEntities.constructor === Object\n  //   ) {\n  //     const imageId = markupEntities[\"imageReferenceUid\"][\"root\"];\n  //     const markupUid = markupEntities[\"uniqueIdentifier\"][\"root\"];\n  //     const calculations = this.getCalculationEntitiesOfMarkUp(aim, markupUid);\n  //     return {\n  //       imageId: imageId,\n  //       markupType: markupEntities[\"xsi:type\"],\n  //       coordinates:\n  //         markupEntities.twoDimensionSpatialCoordinateCollection\n  //           .TwoDimensionSpatialCoordinate,\n  //       calculations: calculations\n  //     };\n  //   }\n  // }\n\n  getDate = () => {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = (\"0\" + (now.getMonth() + 1)).slice(-2);\n    const day = (\"0\" + now.getDate()).slice(-2);\n    const hours = (\"0\" + now.getHours()).slice(-2);\n    const minutes = (\"0\" + now.getMinutes()).slice(-2);\n    const seconds = (\"0\" + now.getSeconds()).slice(-2);\n    return year + month + day + hours + minutes + seconds;\n  };\n\n  _createObject = (name, value) => {\n    var obj = {};\n    obj[name] = { value };\n    return obj;\n  };\n\n  /*                                          */\n  /*  Calculation Entitiy Realted Functions   */\n  /*                                          */\n\n  _createDimension = (label, index = 0, size = 1) => {\n    return {\n      Dimension: [\n        Object.assign(\n          {},\n          this._createObject(\"index\", index),\n          this._createObject(\"size\", size),\n          this._createObject(\"label\", label)\n        ),\n      ],\n    };\n  };\n\n  _createDoubleDataType = () => {\n    var obj = {\n      dataType: {\n        code: \"C48870\",\n        codeSystem: \"NCI\",\n        \"iso:displayName\": {\n          \"xmlns:iso\": \"uri:iso.org:21090\",\n          value: \"Double\",\n        },\n      },\n    };\n    return obj;\n  };\n\n  //preLabel is used for preceding the name like LongAxis || ShortAxis\n  _createCalcResult = (unit, label, value, preLabel = \"\") => {\n    var obj = this._createObject(\"unitOfMeasure\", unit);\n    Object.assign(obj, this._createDoubleDataType());\n    obj[\"xsi:type\"] = \"CompactCalculationResult\";\n    obj[\"dimensionCollection\"] = this._createDimension(preLabel + label);\n    obj[\"type\"] = \"Scalar\";\n    Object.assign(obj, this._createObject(\"value\", `${value}`));\n    return obj;\n  };\n\n  //if called with the default values returns DCM type code\n  _createTypeCode = (\n    code = \"11203\",\n    codeSystemName = \"DCM\",\n    displayNameValue = \"Attenuation Coefficient\"\n  ) => {\n    var obj = {};\n    obj[\"code\"] = code;\n    obj[\"codeSystemName\"] = codeSystemName;\n    obj[\"iso:displayName\"] = {\n      \"xmlns:iso\": \"uri:iso.org:21090\",\n      value: displayNameValue,\n    };\n    return obj;\n  };\n\n  createLengthCalcEntity = (length) => {\n    const { unit, value } = length;\n    const obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [this._createTypeCode(\"G-D7FE\", \"SRT\", \"Length\")];\n    obj[\"description\"] = { value: \"Length\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [this._createCalcResult(unit, \"LineLength\", value)],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  createLongAxisCalcEntity = (longAxis) => {\n    const { unit, value } = longAxis;\n    const obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [this._createTypeCode(\"G-A185\", \"SRT\", \"LongAxis\")];\n    obj[\"description\"] = { value: \"LongAxis\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [this._createCalcResult(unit, \"LongAxis\", value)],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  createShortAxisCalcEntity = (shortAxis) => {\n    const { unit, value } = shortAxis;\n    const obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [this._createTypeCode(\"G-A186\", \"SRT\", \"ShortAxis\")];\n    obj[\"description\"] = { value: \"ShortAxis\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [this._createCalcResult(unit, \"ShortAxis\", value)],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  createAreaCalcEntity = (area) => {\n    const { unit, value } = area;\n    const obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [this._createTypeCode(\"99EPADA4\", \"99EPAD\", \"Area\")];\n    obj[\"description\"] = { value: \"Area\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [this._createCalcResult(unit, \"Area\", value)],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  createVolumeCalcEntity = (volume) => {\n    const { unit, value } = volume;\n    const obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [this._createTypeCode(\"RID28668\", \"Radlex\", \"Volume\")];\n    obj[\"description\"] = { value: \"Volume\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [this._createCalcResult(unit, \"Volume\", value)],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  createMeanCalcEntity = (value, preLabel) => {\n    let typeCodeDcm,\n      { unit, mean } = value;\n    ({ unit, typeCodeDcm } = this._getAimUnitAndDcmTypeCode(unit));\n    var obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [\n      typeCodeDcm,\n      this._createTypeCode(\"R-00317\", \"SRT\", \"Mean\"),\n    ];\n    obj[\"description\"] = { value: \"Mean\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [this._createCalcResult(unit, \"Mean\", mean, preLabel)],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection.CalculationEntity.push(\n      obj\n    );\n    return uId;\n  };\n\n  createStdDevCalcEntity = (value, preLabel) => {\n    let typeCodeDcm,\n      { unit, stdDev } = value;\n    ({ unit, typeCodeDcm } = this._getAimUnitAndDcmTypeCode(unit));\n\n    var obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [\n      typeCodeDcm,\n      this._createTypeCode(\"R-10047\", \"SRT\", \"Standard Deviation\"),\n    ];\n    obj[\"description\"] = { value: \"Standard Deviation\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [\n        this._createCalcResult(unit, \"Standard Deviation\", stdDev, preLabel),\n      ],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  createMinCalcEntity = (value, preLabel) => {\n    let typeCodeDcm,\n      { unit, min } = value;\n    ({ unit, typeCodeDcm } = this._getAimUnitAndDcmTypeCode(unit));\n    var obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [\n      typeCodeDcm,\n      this._createTypeCode(\"R-404FB\", \"SRT\", \"Minimum\"),\n    ];\n    obj[\"description\"] = { value: \"Minimum\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [\n        this._createCalcResult(unit, \"Minimum\", min, preLabel),\n      ],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  createMaxCalcEntity = (value, preLabel) => {\n    let typeCodeDcm,\n      { unit, max } = value;\n    ({ unit, typeCodeDcm } = this._getAimUnitAndDcmTypeCode(unit));\n    var obj = {};\n    const uId = generateUid();\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"typeCode\"] = [\n      typeCodeDcm,\n      this._createTypeCode(\"G-A437\", \"SRT\", \"Maximum\"),\n    ];\n    obj[\"description\"] = { value: \"Maximum\" };\n    obj[\"calculationResultCollection\"] = {\n      CalculationResult: [\n        this._createCalcResult(unit, \"Maximum\", max, preLabel),\n      ],\n    };\n    this.imageAnnotations.ImageAnnotation[0].calculationEntityCollection[\n      \"CalculationEntity\"\n    ].push(obj);\n    return uId;\n  };\n\n  _getAimUnitAndDcmTypeCode = (unit) => {\n    if (unit === \"hu\")\n      return { unit: \"[hnsf'U]\", typeCodeDcm: this._createTypeCode() };\n    else if (unit === \"suv\")\n      return {\n        unit: \"{SUVbw}g/ml\",\n        typeCodeDcm: this._createTypeCode(126401, \"DCM\", \"SUVbw\"),\n      };\n    return { unit, typeCodeDcm: this._createTypeCode() };\n  };\n\n  createCommonCalcEntites = (mean, stdDev, min, max, preLabel) => {\n    var entities = [];\n    entities.push(this.createMeanCalcEntity(mean, preLabel));\n    entities.push(this.createStdDevCalcEntity(stdDev, preLabel));\n    entities.push(this.createMinCalcEntity(min, preLabel));\n    entities.push(this.createMaxCalcEntity(max, preLabel));\n    return entities;\n  };\n\n  // createLineCalcEntities = (length, mean, stdDev, min, max) => {\n  //   var entities = [];\n  //   entities.push(this.createLengthCalcEntity(length));\n  //   return entities.concat(\n  //     this.createCommonCalcEntites(mean, stdDev, min, max)\n  //   );\n  // };\n\n  createLongAxisCalcEntities = (longAxis, mean, stdDev, min, max) => {\n    var entities = [];\n    entities.push(this.createLongAxisCalcEntity(longAxis));\n    return entities.concat(\n      this.createCommonCalcEntites(mean, stdDev, min, max, \"LongAxis_\")\n    );\n  };\n\n  createShortAxisCalcEntities = (shortAxis, mean, stdDev, min, max) => {\n    var entities = [];\n    entities.push(this.createShortAxisCalcEntity(shortAxis));\n    return entities.concat(\n      this.createCommonCalcEntites(mean, stdDev, min, max, \"ShortAxis_\")\n    );\n  };\n\n  createCalculationEntityCollection = (entities) => {\n    var obj = {};\n    obj[\"calculationEntityCollection\"] = { CalculationEntity: entities };\n    return obj;\n  };\n\n  /*                                          */\n  /*  Markup Entitiy Realted Functions        */\n  /*                                          */\n\n  _createCoordinate = (coordinate, index) => {\n    var obj = {};\n    obj[\"coordinateIndex\"] = { value: index };\n    obj[\"x\"] = { value: coordinate.x };\n    obj[\"y\"] = { value: coordinate.y };\n    return obj;\n  };\n\n  _createCoordinateArray = (points) => {\n    var coordinates = [];\n    points.forEach((point, index) => {\n      coordinates.push(this._createCoordinate(point, index));\n    });\n    return coordinates;\n  };\n\n  addMarkupEntity = (type, shapeIndex, points, imageUid, frameNum) => {\n    var obj = {};\n    obj[\"includeFlag\"] = { value: true };\n    obj[\"twoDimensionSpatialCoordinateCollection\"] = {\n      TwoDimensionSpatialCoordinate: this._createCoordinateArray(points),\n    };\n    const uId = generateUid();\n    obj[\"xsi:type\"] = type;\n    this.imageAnnotations.ImageAnnotation[0].markupEntityCollection.MarkupEntity.push(\n      obj\n    );\n    obj[\"uniqueIdentifier\"] = { root: uId };\n    obj[\"shapeIdentifier\"] = { value: shapeIndex };\n    obj[\"includeFlag\"] = { value: true };\n    obj[\"imageReferenceUid\"] = { root: imageUid };\n    obj[\"referencedFrameNumber\"] = { value: frameNum };\n    obj[\"twoDimensionSpatialCoordinateCollection\"] = {\n      TwoDimensionSpatialCoordinate: this._createCoordinateArray(points),\n    };\n    return uId;\n  };\n\n  /*                                          */\n  /*  Image Refrence Entity Collection        */\n  /*                                          */\n  _createModality = () => {\n    const sopClassUid = this.temp.image[0].sopClassUid;\n    if (sopClassUid && modalities[sopClassUid])\n      var {\n        codeValue,\n        codingSchemeDesignator,\n        codeMeaning,\n        codingSchemeVersion,\n      } = modalities[sopClassUid];\n    else {\n      const modality = this.temp.series.modality;\n      if (modality && modalities[modality]) {\n        var {\n          codeValue,\n          codingSchemeDesignator,\n          codeMeaning,\n          codingSchemeVersion,\n        } = modalities[modality];\n      }\n    }\n    var obj = {};\n    obj[\"code\"] = codeValue || \"\";\n    obj[\"codeSystemName\"] = codingSchemeDesignator || \"\";\n    obj[\"iso:displayName\"] = {\n      \"xmlns:iso\": \"uri:iso.org:21090\",\n      value: codeMeaning || \"\",\n    };\n    obj[\"codeSystemVersion\"] = codingSchemeVersion || \"\";\n    return obj;\n  };\n\n  _createImageCollection = () => {\n    let obj = {};\n    obj[\"Image\"] = [];\n    this.temp.image.forEach((image) => {\n      let { sopClassUid, sopInstanceUid } = image;\n      sopClassUid = { root: sopClassUid };\n      sopInstanceUid = { root: sopInstanceUid };\n      obj[\"Image\"].push({ sopClassUid, sopInstanceUid });\n    });\n    return obj;\n  };\n\n  _createImageSeries = () => {\n    var obj = {};\n    obj[\"instanceUid\"] = { root: this.temp.series.instanceUid };\n    obj[\"modality\"] = this._createModality();\n    obj[\"imageCollection\"] = this._createImageCollection();\n    return obj;\n  };\n\n  _createImageStudy = () => {\n    const {\n      accessionNumber,\n      startTime,\n      instanceUid,\n      startDate,\n    } = this.temp.study;\n    var obj = {};\n    obj[\"instanceUid\"] = { root: instanceUid };\n    obj[\"startDate\"] = { value: startDate };\n    obj[\"startTime\"] = { value: startTime };\n    obj[\"accessionNumber\"] = { value: accessionNumber };\n    obj[\"imageSeries\"] = this._createImageSeries();\n    return obj;\n  };\n\n  _createImageReferenceEntity = () => {\n    var obj = {};\n    obj[\"xsi:type\"] = \"DicomImageReferenceEntity\";\n    obj[\"uniqueIdentifier\"] = { root: generateUid() };\n    obj[\"imageStudy\"] = this._createImageStudy();\n    return obj;\n  };\n\n  _createImageReferanceEntityCollection = () => {\n    var obj = {};\n    obj[\"ImageReferenceEntity\"] = [this._createImageReferenceEntity()];\n    return obj;\n  };\n\n  //\n  //\n  //\n  _createImageAnnotations = (aimType) => {\n    const {\n      name,\n      comment,\n      typeCode,\n      imagingPhysicalEntityCollection,\n      imagingObservationEntityCollection,\n      inferenceEntityCollection,\n    } = this.temp.aim;\n    var obj = {};\n    obj[\"uniqueIdentifier\"] = { root: generateUid() };\n    obj[\"typeCode\"] = typeCode;\n    obj[\"dateTime\"] = { value: this.getDate() };\n    obj[\"name\"] = name;\n    obj[\"comment\"] = this._getComment(comment);\n    obj[\"precedentReferencedAnnotationUid\"] = { root: \"\" };\n    if (imagingPhysicalEntityCollection)\n      obj[\"imagingPhysicalEntityCollection\"] = imagingPhysicalEntityCollection;\n    if (aimType === 1) {\n      //if this is an image annotation\n      obj[\"calculationEntityCollection\"] = { CalculationEntity: [] };\n      obj[\"markupEntityCollection\"] = { MarkupEntity: [] };\n      obj[\"imageAnnotationStatementCollection\"] = {\n        ImageAnnotationStatement: [],\n      };\n    }\n    if (imagingObservationEntityCollection)\n      obj[\n        \"imagingObservationEntityCollection\"\n      ] = imagingObservationEntityCollection;\n    if (inferenceEntityCollection)\n      obj[\"inferenceEntityCollection\"] = inferenceEntityCollection;\n    obj[\n      \"imageReferenceEntityCollection\"\n    ] = this._createImageReferanceEntityCollection();\n    return obj;\n  };\n\n  // sanity check to prevent failing for empty comment, but why do I have to send an object with .value?\n  _getComment = (comment) => {\n    if (comment && comment.value) {\n      if (comment.value.length)\n        comment.value = this._getProgrammedComment().concat(\n          \"~~\",\n          comment.value\n        );\n    } else comment.value = this._getProgrammedComment();\n    return comment;\n  };\n\n  _getProgrammedComment = () => {\n    const SEPERATOR = \" / \";\n    const { modality, description, instanceNumber, number } = this.temp.series;\n    const comment =\n      modality +\n      SEPERATOR +\n      description +\n      SEPERATOR +\n      instanceNumber +\n      SEPERATOR +\n      number;\n    return comment;\n  };\n\n  createImageAnnotationStatement = (referenceType, objectId, subjectId) => {\n    //this is called externally\n    var obj = {};\n    var references;\n    referenceType === 1\n      ? (references = \"CalculationEntityReferencesMarkupEntityStatement\")\n      : (references = \"CalculationEntityReferencesSegmentationEntityStatement\");\n    obj[\"xsi:type\"] = references;\n    obj[\"subjectUniqueIdentifier\"] = { root: subjectId };\n    obj[\"objectUniqueIdentifier\"] = { root: objectId };\n    this.imageAnnotations.ImageAnnotation[0].imageAnnotationStatementCollection.ImageAnnotationStatement.push(\n      obj\n    );\n  };\n\n  // createImageAnnotationStatementCollection = () => {\n  //   var obj = {};\n  //   obj[\"ImageAnnotationStatement\"] = [];\n  //   return obj;\n  // };\n\n  // //\n  // //\n  // // Image Annotations\n  // createImageAnnotation = (annotationStatementCollection = {}) => {\n  //   var obj = {};\n  //   obj[\"dateTime\"] = { value: this.getDate() };\n  //   obj[\n  //     \"imageAnnotationStatementCollection\"\n  //   ] = this.createImageAnnotationStatementCollection();\n  //   return obj;\n  // };\n\n  // createImageAnnotations = imageAnnotation => {\n  //   var obj = {};\n  //   obj[\"imageAnnotations\"] = imageAnnotation;\n  //   return obj;\n  // };\n\n  /*                                                */\n  /*    Segmentation Entitiy Realted Functions      */\n  /*                                                */\n\n  createSegmentationEntity = (segmentation) => {\n    var obj = {};\n    obj[\"referencedSopInstanceUid\"] = {\n      root: segmentation.referencedSopInstanceUid,\n    };\n    obj[\"segmentNumber\"] = { value: 1 };\n    obj[\"seriesInstanceUid\"] = {\n      root: segmentation.seriesInstanceUid,\n    };\n    obj[\"studyInstanceUid\"] = {\n      root: segmentation.studyInstanceUid,\n    };\n    obj[\"xsi:type\"] = \"DicomSegmentationEntity\";\n    obj[\"sopClassUid\"] = { root: \"1.2.840.10008.5.1.4.1.1.66.4\" };\n    obj[\"sopInstanceUid\"] = { root: segmentation.sopInstanceUid };\n    obj[\"uniqueIdentifier\"] = { root: generateUid() };\n    const imageAnnotation = this.imageAnnotations.ImageAnnotation[0];\n    if (!imageAnnotation.segmentationEntityCollection) {\n      imageAnnotation.segmentationEntityCollection = {};\n      imageAnnotation.segmentationEntityCollection.SegmentationEntity = [];\n    }\n    imageAnnotation.segmentationEntityCollection.SegmentationEntity.push(obj);\n    return obj[\"uniqueIdentifier\"];\n  };\n\n  //\n  //\n  // Person\n  _createPerson = (person) => {\n    const { sex, name, patientId, birthDate } = person;\n    return {\n      name: { value: name },\n      id: { value: patientId },\n      birthDate: { value: birthDate },\n      sex: { value: sex },\n    };\n  };\n\n  //\n  //\n  // Eqipment\n  _createEquipment = (equipment) => {\n    const {\n      manufacturerName,\n      manufacturerModelName,\n      softwareVersion,\n    } = equipment;\n    return {\n      manufacturerName: { value: manufacturerName },\n      manufacturerModelName: { value: manufacturerModelName },\n      softwareVersion: { value: softwareVersion },\n    };\n  };\n\n  //\n  //\n  // User\n  _createUser = (user) => {\n    const { loginName, name } = user;\n    return {\n      name: { value: name },\n      loginName: { value: loginName },\n      name: { value: name },\n    };\n  };\n\n  getAim = () => {\n    delete this[\"temp\"];\n    const stringAim = JSON.stringify(this);\n    const wrappedAim = `{\"ImageAnnotationCollection\": ${stringAim} } `;\n    return wrappedAim;\n  };\n\n  // new method to get the aim json\n  getAimJSON = () => {\n    return JSON.parse(this.getAim());\n  };\n}\n\nexport default Aim;\n","import Aim from \"./Aim.jsx\";\nexport { Aim };\n\n// moved from aimEditor.jsx\nconst enumAimType = {\n  imageAnnotation: 1,\n  seriesAnnotation: 2,\n  studyAnnotation: 3,\n};\n\nexport function getImageIdAnnotations(aims) {\n  let imageIdSpecificMarkups = {};\n  try {\n    aims.forEach((aim) => parseAim(aim, imageIdSpecificMarkups));\n  } catch (err) {\n    console.log(\"Preparing ImageIdAnnotations\", err);\n  }\n  return imageIdSpecificMarkups;\n}\n\nfunction parseAim(aim, imageIdSpecificMarkups) {\n  var imageAnnotation =\n    aim.ImageAnnotationCollection.imageAnnotations.ImageAnnotation[0];\n  //check if the aim has markup\n  if (imageAnnotation.markupEntityCollection) {\n    var markupEntities = imageAnnotation.markupEntityCollection.MarkupEntity;\n    markupEntities.forEach((markupEntity) => {\n      const { imageId, data } = getMarkup(markupEntity, aim);\n      if (!imageIdSpecificMarkups[imageId])\n        imageIdSpecificMarkups[imageId] = [data];\n      else imageIdSpecificMarkups[imageId].push(data);\n    });\n  }\n  //check if it has segmentation\n  if (imageAnnotation.segmentationEntityCollection) {\n    var segmentationEntities =\n      imageAnnotation.segmentationEntityCollection.SegmentationEntity;\n    segmentationEntities.forEach((segmentationEntity) => {\n      const { imageId, data } = getSegmentation(segmentationEntity, aim);\n      if (!imageIdSpecificMarkups[imageId])\n        imageIdSpecificMarkups[imageId] = [data];\n      else imageIdSpecificMarkups[imageId].push(data);\n    });\n  }\n}\n\nfunction getMarkup(markupEntity, aim) {\n  let imageId = markupEntity[\"imageReferenceUid\"][\"root\"];\n  const frameNumber = markupEntity[\"referencedFrameNumber\"]\n    ? markupEntity[\"referencedFrameNumber\"][\"value\"]\n    : 1;\n  // if (frameNumber > -1) imageId = imageId + \"&frame=\" + frameNumber; //if multiframe reconstruct the imageId\n  imageId = imageId + \"&frame=\" + frameNumber;\n  const markupUid = markupEntity[\"uniqueIdentifier\"][\"root\"];\n  let calculations = [];\n  try {\n    calculations = getCalculationEntitiesOfMarkUp(aim, markupUid);\n  } catch (error) {\n    console.log(\"Can not get calculations\", error);\n  }\n  const aimUid = aim.ImageAnnotationCollection[\"uniqueIdentifier\"][\"root\"];\n  return {\n    imageId,\n    data: {\n      markupType: markupEntity[\"xsi:type\"],\n      calculations,\n      coordinates:\n        markupEntity.twoDimensionSpatialCoordinateCollection\n          .TwoDimensionSpatialCoordinate,\n      markupUid,\n      aimUid,\n    },\n  };\n}\n\nfunction getSegmentation(segmentationEntity, aim) {\n  const imageId = segmentationEntity[\"referencedSopInstanceUid\"][\"root\"];\n  const markupUid = segmentationEntity[\"uniqueIdentifier\"][\"root\"];\n  let calculations = [];\n  try {\n    calculations = getCalculationEntitiesOfMarkUp(aim, markupUid);\n  } catch (error) {\n    console.log(\"Can not get calculations\", error);\n  }\n  const aimUid = aim.ImageAnnotationCollection[\"uniqueIdentifier\"][\"root\"];\n  return {\n    imageId,\n    data: {\n      markupType: segmentationEntity[\"xsi:type\"],\n      calculations,\n      markupUid,\n      aimUid,\n    },\n  };\n}\n\nfunction getCalculationEntitiesOfMarkUp(aim, markupUid) {\n  const imageAnnotationStatements = getImageAnnotationStatements(aim);\n  let calculations = [];\n  imageAnnotationStatements.forEach((statement) => {\n    if (statement.objectUniqueIdentifier.root === markupUid) {\n      const calculationUid = statement.subjectUniqueIdentifier.root;\n      const calculationEntities = getCalculationEntities(aim);\n      calculationEntities.forEach((calculation) => {\n        if (calculation.uniqueIdentifier.root === calculationUid)\n          calculations.push(parseCalculation(calculation));\n      });\n    }\n  });\n  return calculations;\n}\n\nfunction getImageAnnotationStatements(aim) {\n  return aim.ImageAnnotationCollection.imageAnnotations.ImageAnnotation[0]\n    .imageAnnotationStatementCollection.ImageAnnotationStatement;\n}\n\nfunction getCalculationEntities(aim) {\n  return aim.ImageAnnotationCollection.imageAnnotations.ImageAnnotation[0]\n    .calculationEntityCollection.CalculationEntity;\n}\n\nfunction parseCalculation(calculation) {\n  var obj = {};\n  const calcResult =\n    calculation.calculationResultCollection.CalculationResult[0];\n  if (\n    calculation.calculationResultCollection.CalculationResult[0]\n      .calculationDataCollection\n  ) {\n    const calcValue =\n      calculation.calculationResultCollection.CalculationResult[0]\n        .calculationDataCollection.CalculationData[0];\n    obj[\"value\"] = calcValue[\"value\"][\"value\"];\n  } else obj[\"value\"] = calcResult[\"value\"][\"value\"];\n  obj[\"type\"] = calculation[\"description\"][\"value\"];\n  obj[\"unit\"] = calcResult[\"unitOfMeasure\"][\"value\"];\n  return obj;\n}\n\nexport function getAimImageData(image) {\n  var obj = {};\n  obj.aim = {};\n  obj.study = {};\n  obj.series = {};\n  obj.equipment = {};\n  obj.person = {};\n  obj.image = [];\n  const { aim, study, series, equipment, person } = obj;\n\n  aim.studyInstanceUid = image.data.string(\"x0020000d\") || \"\";\n\n  study.startTime = image.data.string(\"x00080030\") || \"\";\n  study.instanceUid = image.data.string(\"x0020000d\") || \"\";\n  study.startDate = image.data.string(\"x00080020\") || \"\";\n  study.accessionNumber = image.data.string(\"x00080050\") || \"\";\n\n  series.instanceUid = image.data.string(\"x0020000e\") || \"\";\n  series.modality = image.data.string(\"x00080060\") || \"\";\n  series.number = image.data.string(\"x00200011\") || \"\";\n  series.description = image.data.string(\"x0008103e\") || \"\";\n  series.instanceNumber = image.data.string(\"x00200013\") || \"\";\n\n  obj.image.push(getSingleImageData(image));\n\n  equipment.manufacturerName = image.data.string(\"x00080070\") || \"\";\n  equipment.manufacturerModelName = image.data.string(\"x00081090\") || \"\";\n  equipment.softwareVersion = image.data.string(\"x00181020\") || \"\";\n\n  person.sex = image.data.string(\"x00100040\") || \"\";\n  person.name = image.data.string(\"x00100010\") || \"\";\n  person.patientId = image.data.string(\"x00100020\") || \"\";\n  person.birthDate = image.data.string(\"x00100030\") || \"\";\n\n  return obj;\n}\n\nfunction getSingleImageData(image) {\n  return {\n    sopClassUid: image.data.string(\"x00080016\") || \"\",\n    sopInstanceUid: image.data.string(\"x00080018\") || \"\",\n  };\n}\n\nfunction addSingleImageDataToAim(aim, image) {\n  if (!aim.image) return;\n  aim.image.push(getSingleImageData(image));\n}\n\n// ---------- aimapi additional methods --------\n// new method inspired by createAimSegmentation in aimEditor.jsx\nexport function createOfflineAimSegmentation(segmentation, userInfo) {\n  // prapare the seed data and create aim\n  const seedData = getAimImageDataFromSeg(segmentation); //aimhelper\n  // admin/ upload user\n  addUserToSeedData(seedData, userInfo);\n  const aim = new Aim(seedData, enumAimType.imageAnnotation); // no this.updatedAimId.\n  // let dataset = await getDatasetFromBlob(segmentation);\n  // if update segmentation Uid should be same as the previous one\n  // console.log('Dataset series uid', segmentation);\n  // fill the segmentation related aim parts\n  const segEntityData = getSegmentationEntityDataFromSeg(segmentation);\n  // TODO fill in stats\n  addSegmentationToAim(aim, segEntityData, {});\n  // console.log('AIM in segmentation', aim);\n  // remove extra entities\n  delete aim.imageAnnotations.ImageAnnotation[0].calculationEntityCollection;\n  delete aim.imageAnnotations.ImageAnnotation[0].markupEntityCollection;\n  delete aim.imageAnnotations.ImageAnnotation[0]\n    .imageAnnotationStatementCollection;\n\n  // add name, comment and segmentation\n  aim.imageAnnotations.ImageAnnotation[0].name = {\n    value: segmentation.SeriesDescription,\n  };\n  // TODO there is no way to fill programmed comment without opening the source image\n  aim.imageAnnotations.ImageAnnotation[0].comment = { value: \"\" };\n  aim.imageAnnotations.ImageAnnotation[0].typeCode = [\n    {\n      code: \"SEG\",\n      codeSystemName: \"99EPAD\",\n      \"iso:displayName\": {\n        \"xmlns:iso\": \"uri:iso.org:21090\",\n        value: \"SEG Only\",\n      },\n    },\n  ];\n\n  return { aim };\n}\n// moved from aimEditor.jsx\nfunction addUserToSeedData(seedData, userInfo) {\n  // this is ui specific, should be changed\n  if (userInfo) {\n    seedData.user = userInfo;\n  } else {\n    let obj = {};\n    obj.loginName = sessionStorage.getItem(\"username\");\n    obj.name = sessionStorage.getItem(\"displayName\");\n    seedData.user = obj;\n  }\n}\n// moved from aimEditor.jsx\nfunction getDatasetFromBlob(segBlob, imageIdx) {\n  return new Promise((resolve) => {\n    let segArrayBuffer;\n    var fileReader = new FileReader();\n    fileReader.onload = (event) => {\n      segArrayBuffer = event.target.result;\n      const dicomData = dcmjs.data.DicomMessage.readFile(segArrayBuffer);\n      const dataset = dcmjs.data.DicomMetaDictionary.naturalizeDataset(\n        dicomData.dict\n      );\n      dataset._meta = dcmjs.data.DicomMetaDictionary.namifyDataset(\n        dicomData.meta\n      );\n      resolve(dataset);\n    };\n    fileReader.readAsArrayBuffer(segBlob);\n  });\n}\n// moved from aimEditor.jsx\nfunction addSegmentationToAim(aim, segEntityData, segStats) {\n  const segId = aim.createSegmentationEntity(segEntityData);\n  const { volume, min, max, mean, stdDev } = segStats;\n  if (mean) {\n    const meanId = aim.createMeanCalcEntity({ mean, unit: \"[hnsf'U]\" });\n    aim.createImageAnnotationStatement(2, segId, meanId);\n  }\n  if (stdDev) {\n    const stdDevId = aim.createStdDevCalcEntity({ stdDev, unit: \"[hnsf'U]\" });\n    aim.createImageAnnotationStatement(2, segId, stdDevId);\n  }\n  if (min) {\n    const minId = aim.createMinCalcEntity({ min, unit: \"[hnsf'U]\" });\n    aim.createImageAnnotationStatement(2, segId, minId);\n  }\n  if (max) {\n    const maxId = aim.createMaxCalcEntity({ max, unit: \"[hnsf'U]\" });\n    aim.createImageAnnotationStatement(2, segId, maxId);\n  }\n  if (volume) {\n    const volumeId = aim.createMaxCalcEntity({ volume, unit: \"mm3\" });\n    aim.createImageAnnotationStatement(2, segId, volumeId);\n  }\n}\n// new method inspired by moved getSegmentationEntityData from aimEditor.jsx\nfunction getSegmentationEntityDataFromSeg(dataset) {\n  const refImage = getRefImageFromSeg(dataset);\n  let obj = {};\n  obj[\"referencedSopInstanceUid\"] = refImage.ReferencedSOPInstanceUID;\n  obj[\"seriesInstanceUid\"] = dataset.SeriesInstanceUID;\n  obj[\"studyInstanceUid\"] = dataset.StudyInstanceUID;\n  obj[\"sopClassUid\"] = dataset.SOPClassUID;\n  obj[\"sopInstanceUid\"] = dataset.SOPInstanceUID;\n  return obj;\n}\n// new method to populate image data from segmentation dicom image\nfunction getAimImageDataFromSeg(image) {\n  var obj = {};\n  obj.aim = {};\n  obj.study = {};\n  obj.series = {};\n  obj.equipment = {};\n  obj.person = {};\n  obj.image = [];\n  const { aim, study, series, equipment, person } = obj;\n  // seg data is coming in dcmjs format\n  aim.studyInstanceUid = image.StudyInstanceUID || \"\";\n  aim.comment = { value: \"\" };\n  study.startTime = image.StudyTime || \"\";\n  study.instanceUid = image.StudyInstanceUID || \"\";\n  study.startDate = image.StudyDate || \"\";\n  study.accessionNumber = image.AccessionNumber || \"\";\n  series.instanceUid = image.ReferencedSeriesSequence.SeriesInstanceUID || \"\";\n  obj.image.push(getSingleImageDataFromSeg(image));\n  equipment.manufacturerName = image.Manufacturer || \"\";\n  equipment.manufacturerModelName = image.ManufacturerModelName || \"\";\n  equipment.softwareVersion = image.SoftwareVersions || \"\";\n  person.sex = image.PatientSex || \"\";\n  person.name = image.PatientName || \"\";\n  person.patientId = image.PatientID || \"\";\n  person.birthDate = image.PatientBirthDate || \"\";\n  return obj;\n}\nfunction getRefImageFromSeg(dataset) {\n  // I needed to check if the sequence is array in each step as dcmjs makes it an object if there is only one item\n  let refImage = '';\n  const firstFrame = Array.isArray(dataset.PerFrameFunctionalGroupsSequence)\n    ? dataset.PerFrameFunctionalGroupsSequence[0]\n    : dataset.PerFrameFunctionalGroupsSequence;\n  if (firstFrame.DerivationImageSequence) {\n    const derivation = Array.isArray(firstFrame.DerivationImageSequence)\n      ? firstFrame.DerivationImageSequence[0]\n      : firstFrame.DerivationImageSequence;\n    refImage = Array.isArray(derivation.SourceImageSequence)\n      ? derivation.SourceImageSequence[0]\n      : derivation.SourceImageSequence;\n  } else if (dataset.ReferencedSeriesSequence) {\n    const refSeries = Array.isArray(dataset.ReferencedSeriesSequence)\n      ? dataset.ReferencedSeriesSequence[0]\n      : dataset.ReferencedSeriesSequence;\n    refImage = Array.isArray(refSeries.ReferencedInstanceSequence)\n      ? refSeries.ReferencedInstanceSequence[0]\n      : refSeries.ReferencedInstanceSequence;\n  }\n  return refImage;\n}\n\n// new method inspired by getSingleImageData to get data from segmentations\nfunction getSingleImageDataFromSeg(image) {\n  const refImage = getRefImageFromSeg(image);\n  return {\n    sopClassUid: refImage.ReferencedSOPClassUID || \"\",\n    sopInstanceUid: refImage.ReferencedSOPInstanceUID || \"\",\n  };\n}\n"],"names":["aimVersion","xmlns","dcmDesignator","lexVersion","modalities","codeValue","codeMeaning","codingSchemeDesignator","codingSchemeVersion","CT","CR","PT","MR","US","MG","generateUid","uid","Math","floor","random","index","Aim","constructor","imageData","aimType","updatedAimId","now","Date","year","getFullYear","month","getMonth","slice","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","name","value","obj","label","size","Dimension","Object","assign","_createObject","dataType","code","codeSystem","unit","preLabel","_createDoubleDataType","_createDimension","codeSystemName","displayNameValue","length","uId","root","_createTypeCode","CalculationResult","_createCalcResult","imageAnnotations","ImageAnnotation","calculationEntityCollection","push","longAxis","shortAxis","area","volume","typeCodeDcm","mean","_getAimUnitAndDcmTypeCode","CalculationEntity","stdDev","min","max","entities","createMeanCalcEntity","createStdDevCalcEntity","createMinCalcEntity","createMaxCalcEntity","createLongAxisCalcEntity","concat","createCommonCalcEntites","createShortAxisCalcEntity","coordinate","x","y","points","coordinates","forEach","point","_createCoordinate","type","shapeIndex","imageUid","frameNum","TwoDimensionSpatialCoordinate","_createCoordinateArray","markupEntityCollection","MarkupEntity","sopClassUid","temp","image","modality","series","sopInstanceUid","instanceUid","_createModality","_createImageCollection","accessionNumber","startTime","startDate","study","_createImageSeries","_createImageStudy","_createImageReferenceEntity","comment","typeCode","imagingPhysicalEntityCollection","imagingObservationEntityCollection","inferenceEntityCollection","aim","_getComment","ImageAnnotationStatement","_createImageReferanceEntityCollection","_getProgrammedComment","SEPERATOR","description","instanceNumber","number","referenceType","objectId","subjectId","references","imageAnnotationStatementCollection","segmentation","referencedSopInstanceUid","seriesInstanceUid","studyInstanceUid","imageAnnotation","segmentationEntityCollection","SegmentationEntity","person","sex","patientId","birthDate","id","equipment","manufacturerName","manufacturerModelName","softwareVersion","user","loginName","stringAim","JSON","stringify","wrappedAim","parse","getAim","aimConf","uniqueIdentifier","dateTime","_createUser","_createEquipment","_createPerson","_createImageAnnotations","undefined","data","enumAimType","seriesAnnotation","studyAnnotation","getImageIdAnnotations","aims","imageIdSpecificMarkups","parseAim","err","console","log","ImageAnnotationCollection","markupEntities","markupEntity","imageId","getMarkup","segmentationEntities","segmentationEntity","getSegmentation","frameNumber","markupUid","calculations","getCalculationEntitiesOfMarkUp","error","aimUid","markupType","twoDimensionSpatialCoordinateCollection","imageAnnotationStatements","getImageAnnotationStatements","statement","objectUniqueIdentifier","calculationUid","subjectUniqueIdentifier","calculationEntities","getCalculationEntities","calculation","parseCalculation","calcResult","calculationResultCollection","calculationDataCollection","calcValue","CalculationData","getAimImageData","string","getSingleImageData","createOfflineAimSegmentation","userInfo","seedData","getAimImageDataFromSeg","addUserToSeedData","segEntityData","getSegmentationEntityDataFromSeg","addSegmentationToAim","SeriesDescription","sessionStorage","getItem","segStats","segId","createSegmentationEntity","meanId","createImageAnnotationStatement","stdDevId","minId","maxId","volumeId","dataset","refImage","getRefImageFromSeg","ReferencedSOPInstanceUID","SeriesInstanceUID","StudyInstanceUID","SOPClassUID","SOPInstanceUID","StudyTime","StudyDate","AccessionNumber","ReferencedSeriesSequence","getSingleImageDataFromSeg","Manufacturer","ManufacturerModelName","SoftwareVersions","PatientSex","PatientName","PatientID","PatientBirthDate","firstFrame","Array","isArray","PerFrameFunctionalGroupsSequence","DerivationImageSequence","derivation","SourceImageSequence","refSeries","ReferencedInstanceSequence","ReferencedSOPClassUID"],"mappings":"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"}